[![npm package](https://nodei.co/npm/vitejs-plugin-electron.png?downloads=true&downloadRank=true&stars=true)](https://www.npmjs.com/package/vitejs-plugin-electron)

# An vite plugin for Electron Renderer-process use NodeJs API.

[![NPM version](https://img.shields.io/npm/v/vitejs-plugin-electron.svg?style=flat)](https://npmjs.org/package/vitejs-plugin-electron)
[![NPM Downloads](https://img.shields.io/npm/dm/vitejs-plugin-electron.svg?style=flat)](https://npmjs.org/package/vitejs-plugin-electron)

## Example ðŸ‘‰ [electron-vite-boilerplate](https://github.com/caoxiemeihao/electron-vite-boilerplate)

## Usage

#### vite.config.ts

  ```ts
  import { defineConfig } from 'vite'
  import electron from 'vitejs-plugin-electron'

  export default defineConfig({
    plugins: [
      electron(),
    ],
    // Required, Electron after packaged use 'file://' protocol.
    base: './',
    build: {
      // Required, correct module resolve after build.
      // Vite will generate multiple files after build, and then index.html with './' relative path load module, instead of the default 'assets' folder.
      assetsDir: '',
      rollupOptions: {
        output: {
          // Required, Electron only supports CommonJs module.
          format: 'cjs',
        },
        // Required, 'electron.externals' includes 'electron' and NodeJs builtin modules.
        external: [...electron.externals],
      },
    },
    optimizeDeps: {
      // Optional.
      exclude: ['electron'],
    },
  })
  ```

#### renderer/foo.ts

  ```ts
  import { ipcRenderer } from 'electron'

  ipcRenderer.on('event-name', () => {
    // somethine code...
  })
  ```

## How to work

> The plugin transform 'electron' and NodeJs builtin modules to ESModule format.

**Using electron in Renderer-process.**

  ```ts
  import { ipcRenderer } from 'electron'
  ```

  The browser's 'electron' request will be returned as follows.

  ```ts
  /**
   * All exports module see https://www.electronjs.org -> API -> Renderer Process Modules
   */
  const {
    clipboard,
    nativeImage,
    shell,
    contextBridge,
    crashReporter,
    ipcRenderer,
    webFrame,
    desktopCapturer,
    deprecate
  } = require('electron');

  export {
    clipboard,
    nativeImage,
    shell,
    contextBridge,
    crashReporter,
    ipcRenderer,
    webFrame,
    desktopCapturer,
    deprecate
  }

  export default {
    clipboard,
    nativeImage,
    shell,
    contextBridge,
    crashReporter,
    ipcRenderer,
    webFrame,
    desktopCapturer,
    deprecate
  };
  ```

**Using NodeJs API in Renderer-process.**

  ```ts
  import { join } from 'path'
  ```

  The browser's 'path' request will be returned as follows.

  ```ts
  const __builtinModule = require('path');

  // These constants are generated by "Object.keys(__builtinModule)"
  const resolve = __builtinModule.resolve;
  const normalize = __builtinModule.normalize;
  const isAbsolute = __builtinModule.isAbsolute;
  const join = __builtinModule.join;
  const relative = __builtinModule.relative;
  const toNamespacedPath = __builtinModule.toNamespacedPath;
  const dirname = __builtinModule.dirname;
  const basename = __builtinModule.basename;
  const extname = __builtinModule.extname;
  const format = __builtinModule.format;
  const parse = __builtinModule.parse;
  const sep = __builtinModule.sep;
  const delimiter = __builtinModule.delimiter;
  const win32 = __builtinModule.win32;
  const posix = __builtinModule.posix;
  const _makeLong = __builtinModule._makeLong;

  export {
    resolve,
    normalize,
    isAbsolute,
    join,
    relative,
    toNamespacedPath,
    dirname,
    basename,
    extname,
    format,
    parse,
    sep,
    delimiter,
    win32,
    posix,
    _makeLong,
  }

  export default { resolve, normalize, isAbsolute, join, relative, toNamespacedPath, dirname, basename, extname, format, parse, sep, delimiter, win32, posix, _makeLong };


  ```
